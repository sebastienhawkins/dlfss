<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Drive Live For Speed Server: C:/inwork/Drive_LFSS/src/server/session.cs Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
<h1>C:/inwork/Drive_LFSS/src/server/session.cs</h1><a href="session_8cs.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="keyword">namespace </span>Drive_LFSS.Server_
<a name="l00002"></a>00002 {
<a name="l00003"></a>00003     <span class="keyword">using</span> System;
<a name="l00004"></a>00004     <span class="keyword">using</span> System.Collections.Generic;
<a name="l00005"></a>00005     <span class="keyword">using</span> System.Threading;
<a name="l00006"></a>00006     <span class="keyword">using</span> Drive_LFSS.Definition_;
<a name="l00007"></a>00007     <span class="keyword">using</span> Drive_LFSS.Socket_;
<a name="l00008"></a>00008     <span class="keyword">using</span> Drive_LFSS.Game_;
<a name="l00009"></a>00009 
<a name="l00010"></a><a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html">00010</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class </span><a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html">Session</a>
<a name="l00011"></a>00011     {
<a name="l00012"></a><a class="code" href="struct_drive___l_f_s_s_1_1_server___1_1_session_1_1_server_struct.html">00012</a>         <span class="keyword">public</span> <span class="keyword">struct </span><a class="code" href="struct_drive___l_f_s_s_1_1_server___1_1_session_1_1_server_struct.html">ServerStruct</a>
<a name="l00013"></a>00013         {<span class="comment">//(/*Racing_Flag.InSim_Flag.ISF_MSO_COLS |*/ InSim_Flag.ISF_MCI), '$', 10000, "dexxa", "Aleajecta S2", 5)))</span>
<a name="l00014"></a><a class="code" href="struct_drive___l_f_s_s_1_1_server___1_1_session_1_1_server_struct.html#22a80be5e35b5c040c64e2ec6b4f295d">00014</a>             <span class="keyword">public</span> <a class="code" href="struct_drive___l_f_s_s_1_1_server___1_1_session_1_1_server_struct.html">ServerStruct</a>(ushort _serverId, <a class="code" href="class_drive___l_f_s_s_1_1_socket___1_1_in_sim_setting.html">InSimSetting</a> _inSimSetting)
<a name="l00015"></a>00015             {
<a name="l00016"></a>00016                 serverId = _serverId;
<a name="l00017"></a>00017                 inSimSetting = _inSimSetting;
<a name="l00018"></a>00018                 server = <span class="keyword">new</span> <a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_server.html">Server</a>(serverId, inSimSetting);
<a name="l00019"></a>00019             }
<a name="l00020"></a><a class="code" href="struct_drive___l_f_s_s_1_1_server___1_1_session_1_1_server_struct.html#e243975749a05d4661defd51197eb6c4">00020</a>             <span class="keyword">public</span> ushort serverId;
<a name="l00021"></a><a class="code" href="struct_drive___l_f_s_s_1_1_server___1_1_session_1_1_server_struct.html#777983f5968e5df2f1a95d2ed2503fe8">00021</a>             <span class="keyword">public</span> <a class="code" href="class_drive___l_f_s_s_1_1_socket___1_1_in_sim_setting.html">InSimSetting</a> inSimSetting;
<a name="l00022"></a><a class="code" href="struct_drive___l_f_s_s_1_1_server___1_1_session_1_1_server_struct.html#4ed73802e298f68ac93af9c970e07c87">00022</a>             <span class="keyword">public</span> <a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_server.html">Server</a> server;
<a name="l00023"></a>00023         }
<a name="l00024"></a>00024 
<a name="l00025"></a>00025         <span class="comment">//ServerId To "Server"</span>
<a name="l00026"></a><a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html#4a74474748ff207fc49cd28f566e4996">00026</a>         <span class="keyword">public</span> <span class="keyword">static</span> Dictionary&lt;ushort, ServerStruct&gt; <a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html#4a74474748ff207fc49cd28f566e4996">serverList</a> = <span class="keyword">new</span> Dictionary&lt;ushort, ServerStruct&gt;();
<a name="l00027"></a>00027 
<a name="l00028"></a><a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html#fe0d624be44d3e848a9b836b6ca51785">00028</a>         <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html#fe0d624be44d3e848a9b836b6ca51785">LoadServerConfig</a>()
<a name="l00029"></a>00029         {
<a name="l00030"></a>00030             <a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html#4a74474748ff207fc49cd28f566e4996">serverList</a>.Add(1, <span class="keyword">new</span> <a class="code" href="struct_drive___l_f_s_s_1_1_server___1_1_session_1_1_server_struct.html">ServerStruct</a>( 1, <span class="keyword">new</span> <a class="code" href="class_drive___l_f_s_s_1_1_socket___1_1_in_sim_setting.html">InSimSetting</a>( <span class="stringliteral">"67.212.66.26"</span>, 30001, 30001, <a class="code" href="namespace_drive___l_f_s_s_1_1_definition__.html#813941ca3376b429a9fc17b4a9e782d7">InSim_Flag</a>.ISF_MSO_COLS | <a class="code" href="namespace_drive___l_f_s_s_1_1_definition__.html#813941ca3376b429a9fc17b4a9e782d7">InSim_Flag</a>.ISF_MCI, <span class="charliteral">'$'</span>, 10000, <span class="stringliteral">"dexxa"</span>, <span class="stringliteral">"Aleajecta S1"</span>, 5 ) ) );
<a name="l00031"></a>00031             <a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html#4a74474748ff207fc49cd28f566e4996">serverList</a>.Add(2, <span class="keyword">new</span> <a class="code" href="struct_drive___l_f_s_s_1_1_server___1_1_session_1_1_server_struct.html">ServerStruct</a>( 2, <span class="keyword">new</span> <a class="code" href="class_drive___l_f_s_s_1_1_socket___1_1_in_sim_setting.html">InSimSetting</a>( <span class="stringliteral">"67.212.66.26"</span>, 29999, 29999, <a class="code" href="namespace_drive___l_f_s_s_1_1_definition__.html#813941ca3376b429a9fc17b4a9e782d7">InSim_Flag</a>.ISF_MSO_COLS | <a class="code" href="namespace_drive___l_f_s_s_1_1_definition__.html#813941ca3376b429a9fc17b4a9e782d7">InSim_Flag</a>.ISF_MCI, <span class="charliteral">'$'</span>, 10000, <span class="stringliteral">"dexxa"</span>, <span class="stringliteral">"Aleajecta S2"</span>, 5 ) ) );
<a name="l00032"></a>00032         }
<a name="l00033"></a>00033 
<a name="l00034"></a><a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html#51c76f310f1874b28557fd7f9fe771e5">00034</a>         <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html#51c76f310f1874b28557fd7f9fe771e5">update</a>(uint diff)
<a name="l00035"></a>00035         {
<a name="l00036"></a>00036             <span class="keywordflow">foreach</span> (KeyValuePair&lt;ushort, ServerStruct&gt; keyPair <span class="keywordflow">in</span> <a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html#4a74474748ff207fc49cd28f566e4996">serverList</a>)
<a name="l00037"></a>00037             {
<a name="l00038"></a>00038                 <span class="keywordflow">if</span> (keyPair.Value.server.connectionRequest)
<a name="l00039"></a>00039                 {
<a name="l00040"></a>00040                     keyPair.Value.server.connectionRequest = <span class="keyword">false</span>;
<a name="l00041"></a>00041 
<a name="l00042"></a>00042                     <span class="keywordflow">if</span>( keyPair.Value.server.socketFlag == <a class="code" href="namespace_drive___l_f_s_s_1_1_definition__.html#46d6d3e7869d62c3da4540b95a01446f">InSim_Socket_State</a>.INSIM_DISCONNECTED )
<a name="l00043"></a>00043                         <a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html#c91204c24f02e10a76cf098d64f45bbf">ConnectToServerId</a>(keyPair.Key);
<a name="l00044"></a>00044                     <span class="keywordflow">continue</span>;
<a name="l00045"></a>00045                 }
<a name="l00046"></a>00046 
<a name="l00047"></a>00047                 <span class="keywordflow">if</span> (keyPair.Value.server.socketFlag == <a class="code" href="namespace_drive___l_f_s_s_1_1_definition__.html#46d6d3e7869d62c3da4540b95a01446f">InSim_Socket_State</a>.INSIM_DISCONNECTED)
<a name="l00048"></a>00048                     <span class="keywordflow">continue</span>;
<a name="l00049"></a>00049 
<a name="l00050"></a>00050                 keyPair.Value.server.update(diff);
<a name="l00051"></a>00051             }
<a name="l00052"></a>00052         }
<a name="l00053"></a><a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html#c91204c24f02e10a76cf098d64f45bbf">00053</a>         <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html#c91204c24f02e10a76cf098d64f45bbf">ConnectToServerId</a>(ushort serverId)
<a name="l00054"></a>00054         {
<a name="l00055"></a>00055             Thread ThreadConnectionProcess = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadStart(<a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html#4a74474748ff207fc49cd28f566e4996">serverList</a>[serverId].server.connect));
<a name="l00056"></a>00056             ThreadConnectionProcess.Start();
<a name="l00057"></a>00057         }
<a name="l00058"></a><a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html#ac2db2ecbca54fd20780d6f7fe31fe0b">00058</a>         <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html#ac2db2ecbca54fd20780d6f7fe31fe0b">exit</a>()
<a name="l00059"></a>00059         {
<a name="l00060"></a>00060             <span class="keywordflow">foreach</span> (KeyValuePair&lt;ushort, ServerStruct&gt; keyPair <span class="keywordflow">in</span> <a class="code" href="class_drive___l_f_s_s_1_1_server___1_1_session.html#4a74474748ff207fc49cd28f566e4996">serverList</a>)
<a name="l00061"></a>00061             {
<a name="l00062"></a>00062                 keyPair.Value.server.exit();
<a name="l00063"></a>00063             }
<a name="l00064"></a>00064         }
<a name="l00065"></a>00065     }
<a name="l00066"></a>00066 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sun Jul 13 14:25:23 2008 for Drive Live For Speed Server by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
